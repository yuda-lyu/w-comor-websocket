/*!
 * ws-client v1.0.26
 * (c) 2018-2019 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("ws")):"function"==typeof define&&define.amd?define(["ws"],e):(t=t||self)["ws-client"]=e(t.ws)}(this,(function(t){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}t=t&&t.hasOwnProperty("default")?t.default:t;var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var r=function(t,e){return t(e={exports:{}},e.exports),e.exports}((function(t){!function(n){function r(){}var o=r.prototype,i=n.EventEmitter;function u(t,e){for(var n=t.length;n--;)if(t[n].listener===e)return n;return-1}function s(t){return function(){return this[t].apply(this,arguments)}}o.getListeners=function(t){var e,n,r=this._getEvents();if(t instanceof RegExp)for(n in e={},r)r.hasOwnProperty(n)&&t.test(n)&&(e[n]=r[n]);else e=r[t]||(r[t]=[]);return e},o.flattenListeners=function(t){var e,n=[];for(e=0;e<t.length;e+=1)n.push(t[e].listener);return n},o.getListenersAsObject=function(t){var e,n=this.getListeners(t);return n instanceof Array&&((e={})[t]=n),e||n},o.addListener=function(t,n){if(!function t(n){return"function"==typeof n||n instanceof RegExp||!(!n||"object"!==e(n))&&t(n.listener)}(n))throw new TypeError("listener must be a function");var r,o=this.getListenersAsObject(t),i="object"===e(n);for(r in o)o.hasOwnProperty(r)&&-1===u(o[r],n)&&o[r].push(i?n:{listener:n,once:!1});return this},o.on=s("addListener"),o.addOnceListener=function(t,e){return this.addListener(t,{listener:e,once:!0})},o.once=s("addOnceListener"),o.defineEvent=function(t){return this.getListeners(t),this},o.defineEvents=function(t){for(var e=0;e<t.length;e+=1)this.defineEvent(t[e]);return this},o.removeListener=function(t,e){var n,r,o=this.getListenersAsObject(t);for(r in o)o.hasOwnProperty(r)&&-1!==(n=u(o[r],e))&&o[r].splice(n,1);return this},o.off=s("removeListener"),o.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},o.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},o.manipulateListeners=function(t,n,r){var o,i,u=t?this.removeListener:this.addListener,s=t?this.removeListeners:this.addListeners;if("object"!==e(n)||n instanceof RegExp)for(o=r.length;o--;)u.call(this,n,r[o]);else for(o in n)n.hasOwnProperty(o)&&(i=n[o])&&("function"==typeof i?u.call(this,o,i):s.call(this,o,i));return this},o.removeEvent=function(t){var n,r=e(t),o=this._getEvents();if("string"===r)delete o[t];else if(t instanceof RegExp)for(n in o)o.hasOwnProperty(n)&&t.test(n)&&delete o[n];else delete this._events;return this},o.removeAllListeners=s("removeEvent"),o.emitEvent=function(t,e){var n,r,o,i,u=this.getListenersAsObject(t);for(i in u)if(u.hasOwnProperty(i))for(n=u[i].slice(0),o=0;o<n.length;o++)!0===(r=n[o]).once&&this.removeListener(t,r.listener),r.listener.apply(this,e||[])===this._getOnceReturnValue()&&this.removeListener(t,r.listener);return this},o.trigger=s("emitEvent"),o.emit=function(t){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,e)},o.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},o._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},o._getEvents=function(){return this._events||(this._events={})},r.noConflict=function(){return n.EventEmitter=i,r},t.exports?t.exports=r:n.EventEmitter=r}("undefined"!=typeof window?window:n||{})}));function o(t){var e=Object.prototype.toString.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e}function i(e){var n=null;e.url||(e.url="ws://localhost:8080"),e.token||(e.token="*");var r,i=function(){var t="undefined"!=typeof window&&void 0!==window.document,e="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope;return{isBrowser:t=t||e,isWebWorker:e,isNode:"undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node}}().isBrowser;r=i?("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:null).WebSocket:t;try{n=new r(e.url+"/?token="+e.token)}catch(t){n=null}if(null===n)return{error:"can not new MixWS"};function u(){o(e.open)&&e.open()}function s(){o(e.close)&&e.close()}function a(t){o(e.message)&&e.message(t)}function c(t){o(e.error)&&e.error(t),n.close()}return i?(n.onopen=u,n.onmessage=function(t){a(t.data)},n.onclose=s,n.onerror=c):(n.on("open",u),n.on("message",a),n.on("close",s),n.on("error",c)),n}var u=Array.isArray,s="object"==e(n)&&n&&n.Object===Object&&n,a="object"==("undefined"==typeof self?"undefined":e(self))&&self&&self.Object===Object&&self,c=s||a||Function("return this")(),f=c.Symbol,l=Object.prototype,v=l.hasOwnProperty,p=l.toString,h=f?f.toStringTag:void 0;var d=function(t){var e=v.call(t,h),n=t[h];try{t[h]=void 0;var r=!0}catch(t){}var o=p.call(t);return r&&(e?t[h]=n:delete t[h]),o},y=Object.prototype.toString;var _=function(t){return y.call(t)},g="[object Null]",b="[object Undefined]",m=f?f.toStringTag:void 0;var w=function(t){return null==t?void 0===t?b:g:m&&m in Object(t)?d(t):_(t)};var O=function(t){return null!=t&&"object"==e(t)},j="[object Symbol]";var L=function(t){return"symbol"==e(t)||O(t)&&w(t)==j},E=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,S=/^\w*$/;var P=function(t,n){if(u(t))return!1;var r=e(t);return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!L(t))||(S.test(t)||!E.test(t)||null!=n&&t in Object(n))};var x=function(t){var n=e(t);return null!=t&&("object"==n||"function"==n)},k="[object AsyncFunction]",A="[object Function]",$="[object GeneratorFunction]",z="[object Proxy]";var R,N=function(t){if(!x(t))return!1;var e=w(t);return e==A||e==$||e==k||e==z},F=c["__core-js_shared__"],T=(R=/[^.]+$/.exec(F&&F.keys&&F.keys.IE_PROTO||""))?"Symbol(src)_1."+R:"";var M=function(t){return!!T&&T in t},V=Function.prototype.toString;var W=function(t){if(null!=t){try{return V.call(t)}catch(t){}try{return t+""}catch(t){}}return""},C=/^\[object .+?Constructor\]$/,G=Function.prototype,B=Object.prototype,I=G.toString,J=B.hasOwnProperty,q=RegExp("^"+I.call(J).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var U=function(t){return!(!x(t)||M(t))&&(N(t)?q:C).test(W(t))};var D=function(t,e){return null==t?void 0:t[e]};var H=function(t,e){var n=D(t,e);return U(n)?n:void 0},K=H(Object,"create");var Q=function(){this.__data__=K?K(null):{},this.size=0};var X=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Y="__lodash_hash_undefined__",Z=Object.prototype.hasOwnProperty;var tt=function(t){var e=this.__data__;if(K){var n=e[t];return n===Y?void 0:n}return Z.call(e,t)?e[t]:void 0},et=Object.prototype.hasOwnProperty;var nt=function(t){var e=this.__data__;return K?void 0!==e[t]:et.call(e,t)},rt="__lodash_hash_undefined__";var ot=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=K&&void 0===e?rt:e,this};function it(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}it.prototype.clear=Q,it.prototype.delete=X,it.prototype.get=tt,it.prototype.has=nt,it.prototype.set=ot;var ut=it;var st=function(){this.__data__=[],this.size=0};var at=function(t,e){return t===e||t!=t&&e!=e};var ct=function(t,e){for(var n=t.length;n--;)if(at(t[n][0],e))return n;return-1},ft=Array.prototype.splice;var lt=function(t){var e=this.__data__,n=ct(e,t);return!(n<0)&&(n==e.length-1?e.pop():ft.call(e,n,1),--this.size,!0)};var vt=function(t){var e=this.__data__,n=ct(e,t);return n<0?void 0:e[n][1]};var pt=function(t){return ct(this.__data__,t)>-1};var ht=function(t,e){var n=this.__data__,r=ct(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this};function dt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}dt.prototype.clear=st,dt.prototype.delete=lt,dt.prototype.get=vt,dt.prototype.has=pt,dt.prototype.set=ht;var yt=dt,_t=H(c,"Map");var gt=function(){this.size=0,this.__data__={hash:new ut,map:new(_t||yt),string:new ut}};var bt=function(t){var n=e(t);return"string"==n||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==t:null===t};var mt=function(t,e){var n=t.__data__;return bt(e)?n["string"==typeof e?"string":"hash"]:n.map};var wt=function(t){var e=mt(this,t).delete(t);return this.size-=e?1:0,e};var Ot=function(t){return mt(this,t).get(t)};var jt=function(t){return mt(this,t).has(t)};var Lt=function(t,e){var n=mt(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};function Et(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Et.prototype.clear=gt,Et.prototype.delete=wt,Et.prototype.get=Ot,Et.prototype.has=jt,Et.prototype.set=Lt;var St=Et,Pt="Expected a function";function xt(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(Pt);var n=function n(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var u=t.apply(this,r);return n.cache=i.set(o,u)||i,u};return n.cache=new(xt.Cache||St),n}xt.Cache=St;var kt=xt,At=500;var $t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,zt=/\\(\\)?/g,Rt=function(t){var e=kt(t,(function(t){return n.size===At&&n.clear(),t})),n=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace($t,(function(t,n,r,o){e.push(r?o.replace(zt,"$1"):n||t)})),e}));var Nt=function(t,e){for(var n=-1,r=null==t?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o},Ft=1/0,Tt=f?f.prototype:void 0,Mt=Tt?Tt.toString:void 0;var Vt=function t(e){if("string"==typeof e)return e;if(u(e))return Nt(e,t)+"";if(L(e))return Mt?Mt.call(e):"";var n=e+"";return"0"==n&&1/e==-Ft?"-0":n};var Wt=function(t){return null==t?"":Vt(t)};var Ct=function(t,e){return u(t)?t:P(t,e)?[t]:Rt(Wt(t))},Gt=1/0;var Bt=function(t){if("string"==typeof t||L(t))return t;var e=t+"";return"0"==e&&1/t==-Gt?"-0":e};var It=function(t,e){for(var n=0,r=(e=Ct(e,t)).length;null!=t&&n<r;)t=t[Bt(e[n++])];return n&&n==r?t:void 0};var Jt=function(t,e,n){var r=null==t?void 0:It(t,e);return void 0===r?n:r},qt=function(){try{var t=H(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();var Ut=function(t,e,n){"__proto__"==e&&qt?qt(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n},Dt=Object.prototype.hasOwnProperty;var Ht=function(t,e,n){var r=t[e];Dt.call(t,e)&&at(r,n)&&(void 0!==n||e in t)||Ut(t,e,n)},Kt=9007199254740991,Qt=/^(?:0|[1-9]\d*)$/;var Xt=function(t,n){var r=e(t);return!!(n=null==n?Kt:n)&&("number"==r||"symbol"!=r&&Qt.test(t))&&t>-1&&t%1==0&&t<n};var Yt=function(t,e,n,r){if(!x(t))return t;for(var o=-1,i=(e=Ct(e,t)).length,u=i-1,s=t;null!=s&&++o<i;){var a=Bt(e[o]),c=n;if(o!=u){var f=s[a];void 0===(c=r?r(f,a,s):void 0)&&(c=x(f)?f:Xt(e[o+1])?[]:{})}Ht(s,a,c),s=s[a]}return t};var Zt=function(t,e,n){return null==t?t:Yt(t,e,n)};function te(){var t,e,n=new Promise((function(){t=arguments[0],e=arguments[1]}));return n.resolve=t,n.reject=e,n}var ee=NaN,ne=/^\s+|\s+$/g,re=/^[-+]0x[0-9a-f]+$/i,oe=/^0b[01]+$/i,ie=/^0o[0-7]+$/i,ue=parseInt;var se=function(t){if("number"==typeof t)return t;if(L(t))return ee;if(x(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=x(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(ne,"");var n=oe.test(t);return n||ie.test(t)?ue(t.slice(2),n?2:8):re.test(t)?ee:+t},ae=1/0,ce=17976931348623157e292;var fe=function(t){return t?(t=se(t))===ae||t===-ae?(t<0?-1:1)*ce:t==t?t:0:0===t?t:0};var le=function(t){var e=fe(t),n=e%1;return e==e?n?e-n:e:0};var ve=function(t){return"number"==typeof t&&t==le(t)};function pe(t){return!(!function(t){return"[object String]"===Object.prototype.toString.call(t)}(t)||""===t)}function he(t){var e=!1;return pe(t)?e=!isNaN(Number(t)):function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)&&(e=!0),e}function de(t){return he(t)?fe(t):0}var ye=c.isFinite,_e=Math.min;var ge=function(t){var e=Math[t];return function(t,n){if(t=se(t),(n=null==n?0:_e(le(n),292))&&ye(t)){var r=(Wt(t)+"e").split("e"),o=e(r[0]+"e"+(+r[1]+n));return+((r=(Wt(o)+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}("round");function be(t){return!!function(t){return!!he(t)&&(t=de(t),ve(t))}(t)&&function(t){if(!he(t))return 0;t=de(t);var e=ge(t);return"0"===String(e)?0:e}(t)>0}return function(t){var e=te(),n=null,u={},s=new r;function a(){var r={url:null,token:null,open:function(){!function(){o(t.open)&&t.open();a("getFuncs",null)}()},close:function(){!function(){o(t.close)&&t.close();c()}()},message:function(t){!function(t){var n=function(t){if(!pe(t))return{};var e={};try{e=JSON.parse(t)}catch(t){e={}}return e}(t);if("sys"===Jt(n,"output.sys")&&Jt(n,"output.funcs")){var r=n.output.funcs;u={};for(var o=function(t){var e=r[t];Zt(u,e,(function(t){return a(e,t)}))},i=0;i<r.length;i++)o(i);e.resolve(u)}if(Jt(n,"_id")&&Jt(n,"output")){var c=Jt(n,"_id"),f=Jt(n,"output");s.emit(c,f)}}(t)},error:function(e){!function(e){o(t.error)&&t.error(e);n.close()}(e)}};t.url||(r.url="ws://localhost:8080"),t.token||(r.token="*");try{n=new i(r)}catch(t){return c(),null}if(Jt(n,"error"))return c(),null;function a(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=te(),u=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=[],o=n.length;if(be(e))for(t=0;t<e;t++)r[t]=n[0|Math.random()*o];else{if("rfc4122"!==e)return"";var i;for(r[8]=r[13]=r[18]=r[23]="-",r[14]="4",t=0;t<36;t++)r[t]||(i=0|16*Math.random(),r[t]=n[19===t?3&i|8:i])}return r.join("")}(),a={token:t.token,_id:u,func:e,input:r};return n.readyState===n.OPEN&&n.send(JSON.stringify(a),(function(e){e&&o(t.error)&&t.error(e)})),s.on(u,(function(t){i.resolve(t),s.removeAllListeners(u)})),i}}function c(){setTimeout((function(){o(t.reconn)&&t.reconn(),a()}),1e3)}return a(),e}}));
//# sourceMappingURL=ws-client.umd.js.map
